{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Varshil/Google%20Drive/It-Vedant/ComunityHere/Community/lib/mongodb.ts"],"sourcesContent":["import { MongoClient } from \"mongodb\"\r\n\r\nif (!process.env.MONGODB_URI) {\r\n  throw new Error('Invalid/Missing environment variable: \"MONGODB_URI\"')\r\n}\r\n\r\nconst uri = process.env.MONGODB_URI\r\nconst options = {\r\n  serverSelectionTimeoutMS: 5000, // Timeout after 5s instead of 30s\r\n  socketTimeoutMS: 45000, // Close sockets after 45s of inactivity\r\n}\r\n\r\nlet client: MongoClient\r\nlet clientPromise: Promise<MongoClient>\r\n\r\nif (process.env.NODE_ENV === \"development\") {\r\n  let globalWithMongo = global as typeof globalThis & {\r\n    _mongoClientPromise?: Promise<MongoClient>\r\n  }\r\n\r\n  if (!globalWithMongo._mongoClientPromise) {\r\n    client = new MongoClient(uri, options)\r\n    globalWithMongo._mongoClientPromise = client.connect().catch((error) => {\r\n      console.error(\"MongoDB connection error:\", error)\r\n      throw error\r\n    })\r\n  }\r\n  clientPromise = globalWithMongo._mongoClientPromise!\r\n} else {\r\n  client = new MongoClient(uri, options)\r\n  clientPromise = client.connect()\r\n}\r\n\r\nexport default clientPromise\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,IAAI,CAAC,QAAQ,GAAG,CAAC,WAAW,EAAE;IAC5B,MAAM,IAAI,MAAM;AAClB;AAEA,MAAM,MAAM,QAAQ,GAAG,CAAC,WAAW;AACnC,MAAM,UAAU;IACd,0BAA0B;IAC1B,iBAAiB;AACnB;AAEA,IAAI;AACJ,IAAI;AAEJ,wCAA4C;IAC1C,IAAI;IAIJ,IAAI,CAAC,gBAAgB,mBAAmB,EAAE;QACxC,SAAS,IAAI,sHAAW,CAAC,KAAK;QAC9B,gBAAgB,mBAAmB,GAAG,OAAO,OAAO,GAAG,KAAK,CAAC,CAAC;YAC5D,QAAQ,KAAK,CAAC,6BAA6B;YAC3C,MAAM;QACR;IACF;IACA,gBAAgB,gBAAgB,mBAAmB;AACrD;;uCAKe","debugId":null}},
    {"offset": {"line": 91, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Varshil/Google%20Drive/It-Vedant/ComunityHere/Community/app/api/auth/signup/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\"\r\nimport clientPromise from \"@/lib/mongodb\"\r\nimport bcrypt from \"bcryptjs\"\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const { name, email, password, college, department, role } = await request.json()\r\n\r\n    // Validation\r\n    if (!name || !email || !password || !college || !department) {\r\n      return NextResponse.json({ error: \"Missing required fields\" }, { status: 400 })\r\n    }\r\n\r\n    if (password.length < 6) {\r\n      return NextResponse.json({ error: \"Password must be at least 6 characters\" }, { status: 400 })\r\n    }\r\n\r\n    // Check MongoDB connection\r\n    if (!process.env.MONGODB_URI) {\r\n      console.error(\"MONGODB_URI is not set in environment variables\")\r\n      return NextResponse.json({ error: \"Database configuration error. Please contact administrator.\" }, { status: 500 })\r\n    }\r\n\r\n    let client\r\n    try {\r\n      client = await clientPromise\r\n    } catch (connectionError: any) {\r\n      console.error(\"MongoDB connection error:\", connectionError)\r\n      return NextResponse.json({ \r\n        error: process.env.NODE_ENV === \"development\" \r\n          ? `Database connection failed: ${connectionError.message}` \r\n          : \"Database connection failed. Please check your MongoDB connection.\" \r\n      }, { status: 500 })\r\n    }\r\n\r\n    const db = client.db(\"CommunityHere\")\r\n    const usersCollection = db.collection(\"users\")\r\n\r\n    // Check if user already exists\r\n    const existingUser = await usersCollection.findOne({ email })\r\n    if (existingUser) {\r\n      return NextResponse.json({ error: \"User already exists\" }, { status: 400 })\r\n    }\r\n\r\n    // Hash password\r\n    const hashedPassword = await bcrypt.hash(password, 10)\r\n\r\n    // Create new user\r\n    const result = await usersCollection.insertOne({\r\n      name,\r\n      email,\r\n      password: hashedPassword,\r\n      college,\r\n      department,\r\n      role: role || \"student\",\r\n      createdAt: new Date(),\r\n      updatedAt: new Date(),\r\n    })\r\n\r\n    return NextResponse.json(\r\n      {\r\n        message: \"User created successfully\",\r\n        userId: result.insertedId,\r\n      },\r\n      { status: 201 },\r\n    )\r\n  } catch (error: any) {\r\n    console.error(\"Signup error:\", error)\r\n    // Return more detailed error message in development\r\n    const errorMessage = process.env.NODE_ENV === \"development\" \r\n      ? error.message || \"Internal server error\"\r\n      : \"Internal server error\"\r\n    return NextResponse.json({ error: errorMessage }, { status: 500 })\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,QAAQ,EAAE,OAAO,EAAE,UAAU,EAAE,IAAI,EAAE,GAAG,MAAM,QAAQ,IAAI;QAE/E,aAAa;QACb,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,YAAY,CAAC,WAAW,CAAC,YAAY;YAC3D,OAAO,6UAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA0B,GAAG;gBAAE,QAAQ;YAAI;QAC/E;QAEA,IAAI,SAAS,MAAM,GAAG,GAAG;YACvB,OAAO,6UAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAyC,GAAG;gBAAE,QAAQ;YAAI;QAC9F;QAEA,2BAA2B;QAC3B,IAAI,CAAC,QAAQ,GAAG,CAAC,WAAW,EAAE;YAC5B,QAAQ,KAAK,CAAC;YACd,OAAO,6UAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA8D,GAAG;gBAAE,QAAQ;YAAI;QACnH;QAEA,IAAI;QACJ,IAAI;YACF,SAAS,MAAM,yLAAa;QAC9B,EAAE,OAAO,iBAAsB;YAC7B,QAAQ,KAAK,CAAC,6BAA6B;YAC3C,OAAO,6UAAY,CAAC,IAAI,CAAC;gBACvB,OAAO,uCACH,CAAC,4BAA4B,EAAE,gBAAgB,OAAO,EAAE,GACxD;YACN,GAAG;gBAAE,QAAQ;YAAI;QACnB;QAEA,MAAM,KAAK,OAAO,EAAE,CAAC;QACrB,MAAM,kBAAkB,GAAG,UAAU,CAAC;QAEtC,+BAA+B;QAC/B,MAAM,eAAe,MAAM,gBAAgB,OAAO,CAAC;YAAE;QAAM;QAC3D,IAAI,cAAc;YAChB,OAAO,6UAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAsB,GAAG;gBAAE,QAAQ;YAAI;QAC3E;QAEA,gBAAgB;QAChB,MAAM,iBAAiB,MAAM,iQAAM,CAAC,IAAI,CAAC,UAAU;QAEnD,kBAAkB;QAClB,MAAM,SAAS,MAAM,gBAAgB,SAAS,CAAC;YAC7C;YACA;YACA,UAAU;YACV;YACA;YACA,MAAM,QAAQ;YACd,WAAW,IAAI;YACf,WAAW,IAAI;QACjB;QAEA,OAAO,6UAAY,CAAC,IAAI,CACtB;YACE,SAAS;YACT,QAAQ,OAAO,UAAU;QAC3B,GACA;YAAE,QAAQ;QAAI;IAElB,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,iBAAiB;QAC/B,oDAAoD;QACpD,MAAM,eAAe,uCACjB,MAAM,OAAO,IAAI,0BACjB;QACJ,OAAO,6UAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAa,GAAG;YAAE,QAAQ;QAAI;IAClE;AACF","debugId":null}}]
}